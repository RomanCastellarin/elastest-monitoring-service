stream string cookie := if e.path(cookie) then e.getstr(cookie) 
stream string usr := if e.path(cookie) then e.getstr(usr)

stream bool getVerdict := if e.path(getVerdict) then e.strcmp(getVerdict, "true")

stream string op := if e.path(op) then e.getstr(op)
strean string arg := if e.path(arg) then e.getstr(arg)

stream bool goodLogin := op = "login" /\ arg = usr
stream bool goodTest := op = "test" /\ arg = cookie 
stream bool goodLogout := op = "logout" /\ arg = prev(cookie)
stream bool goodTransition := goodLogin \/ goodTest \/ goodLogout
stream string verdict := if goodTransition then "ok" else "fail"
trigger getVerdict do emit `{"verdict": "%verdict", "op": "%op", "arg": "%arg"}` on #out
